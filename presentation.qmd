---
title: Study Group Recommender with Machine Learning
subtitle: "Developed: by class of DATA322 Presented: by Team Machines"
execute:
   error: true
jupyter: python3
format: pptx

#  revealjs:
#    theme: default
---

<style>
h1, h2, h3, h4, h5, h6 {
  font-size: 25px !important;
}

p, li, span {
  font-size: 14px !important;
}
</style>

```{python}
#| echo: false

import qrcode
import matplotlib.pyplot as plt
```

# Problem Overview
Many students struggle with understanding course material, staying accountable, and performing well on exams. While study groups can feel intimidating, research shows they significantly improve comprehension, retention, and exam scores. Now the big question is: How do we create effective study groups that maximize learning, accountability, and confidence while minimizing the fear of participation?


# Data Collection - Fill Out This Form!
:::: {.columns}
::: {.column width="40%"}
First, please fill out our short survey, which we’ll use to recommend everyone’s study groups! While you are all filling that out, we’ll begin talking about the methods used in our hierarchical clustering algorithm. You are all your own cluster to start, but will begin merging together one by one based on similarity and differences in responses!
:::
::: {.column width="60%"}
```{python}
url="https://docs.google.com/forms/d/e/1FAIpQLSdO8crqtnLQZqj-13miPjY7mofl3iHILaMsBXpKWxbkXv0R2w/viewform"
# Create QR code

qr=qrcode.QRCode(version=None, box_size=8, border=4)
qr.add_data(url)
qr.make(fit=True)
img = qrcode.make(url).convert("RGB") 
#img=qr.make_image(fill_color="black", back_color="white")
# Display QR code
plt.imshow(img)
plt.axis("off")
plt.show()
```
::: 
::::

# Gower’s for Distances Between Clusters
![Gower's Method](gowers_method.png)

# How does our distance work between students?
We calculate similarity between students based on:

**(Numeric variables)** (i.e., study hours per week, quiz/exam scores)

* Measured by normalized numerical difference.

**(Categorical variables)** (i.e, major, preferred study style, availability, learning preference).

* Measured by 0 if they match, 1 if they differ.
Each variable contributes equally or weighted if needed to an overall similarity score.

**(Final Distance Score)**
Distance ranges from 0 to 1.

* 0 = Very similar students

* 1 = Very different students

Students with **(smaller distances)** are grouped together in the recommender system to create balanced, compatible study groups.


# Complete Linkage for Merging Clusters
:::: {.columns}

::: {.column width="40%"}
Complete linkage describes the metric we use to decide the merging of clusters. In particular, we merge the minimum distance created by the farthest points within two clusters, which is found by comparing the distances from every pair of points between the clusters.
:::

::: {.column width="60%"}
![Visualization of Complete Linkage](complete_linkage.png)
:::

::::

# Tidy Data Collected 
[Open live dataset](https://docs.google.com/spreadsheets/d/1IxP1wH9CJMFxqZI-ZSt8q-EcQtlF5mnP-btR4SKDWV4/edit?usp=sharing)

# Let's Look at the Code

# Our Results Visualized as a Dendrogram 

# Group Recommendations and Student Assignment

# Evaluation Form (from Presenting Team)
:::: {.columns}
::: {.column width="40%"}
Feedback from the evaluation form will be anonymous, however the results will help us all improve future iterations of our model generalized to all students. ** Ask Rosanna if she wants to share the results to them later on **
:::
::: {.column width="60%"}
```{python}
url="https://forms.gle/mBq7GdZiLTy8Ydhf9"
# Create QR code

qr=qrcode.QRCode(version=None, box_size=10, border=4)
qr.add_data(url)
qr.make(fit=True)
img = qrcode.make(url).convert("RGB") 
#img=qr.make_image(fill_color="black", back_color="white")
# Display QR code
plt.imshow(img)
plt.axis("off")
plt.show()
```

:::
::::

# Credits
- Presented by Team Machines:
    - Anthony Wolfe - Project Coordinator
    - Dean Callahan - Technical Lead
    - Jonathan Juarez - Data Scientist
    - Devon Walker - Data Scientist

- Data and Question Design By: Team SARA
- Distance and Clustering By: Team Errors







<!-- testing notebook rendering -->
```{python}
#!pip install google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client
from google.colab import auth
auth.authenticate_user()
import gspread
from google.auth import default
creds, _ = default() # get_application_default() is deprecated

gc = gspread.authorize(creds) # gspread now expects google-auth credentials
# Taken from last year's notebook

#!pip install ISLP

import seaborn as sns
import numpy as np
import sklearn
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA
from sklearn.preprocessing import StandardScaler
import re

from sklearn.cluster import \
     (KMeans,
      AgglomerativeClustering)
from scipy.spatial.distance import pdist, squareform
from ISLP.cluster import compute_linkage
from scipy.cluster.hierarchy import \
     (dendrogram,
      cut_tree,
      linkage)
#pip install gower
import gower
```

```{python}
# import data from google survey

# real one
wb = gc.open_by_url('https://docs.google.com/spreadsheets/d/1IxP1wH9CJMFxqZI-ZSt8q-EcQtlF5mnP-btR4SKDWV4/edit?gid=804837988#gid=804837988')

# simulated
# wb = gc.open_by_url('https://docs.google.com/spreadsheets/d/1fiIOkwfttAIv5P0ca6IcVdAk5IAG-WrThyriQiXPRIQ/edit?gid=1707814890#gid=1707814890')

sheet = wb.sheet1

print("Hello")
```